on:
    push:
    pull_request:

permissions:
    contents: read
    pull-requests: write

env:
    NEXT_PUBLIC_SERVER_URL: http://localhost:3000

jobs:
    cache-and-install:
        runs-on: ${{ matrix.os }}

        strategy:
            matrix:
                os: [ubuntu-latest, windows-latest, macos-latest]
                node: [18, 20]

        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Install pnpm
              uses: pnpm/action-setup@v4
              with:
                  version: 10.7.1
                  run_install: false

            - name: Install Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: ${{ matrix.node }}
                  cache: "pnpm"

            - name: Install dependencies
              run: pnpm install

            - name: Build project
              run: pnpm run build
